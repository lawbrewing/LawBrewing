<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Taproom</title>
    <style>
        :root {
            --bg-color: #2c241b;
            --panel-bg: #3a2e24;
            --text-gold: #f0c05a;
            --accent: #5c9e60; 
            --danger: #d9534f;
            --card-bg: #f4e4bc;
            --parchment: #e8dcb5;
            --ink: #2a2a2a;
        }

        body {
            font-family: 'Courier New', Courier, monospace;
            background-color: var(--bg-color);
            color: #ddd;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            text-align: center;
            padding-bottom: 70px;
        }

        h1 { color: var(--text-gold); text-shadow: 2px 2px #000; margin-bottom: 5px; }

        /* CONTAINERS */
        .screen {
            width: 100%; max-width: 600px; padding: 10px;
            box-sizing: border-box; display: none; animation: fadeIn 0.5s;
        }
        .active-screen { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* BUTTONS */
        .btn-main {
            background: var(--text-gold); color: #2c241b; border: none;
            padding: 15px 25px; font-size: 1.1em; font-weight: bold;
            cursor: pointer; border-radius: 5px; margin: 10px; width: 80%;
            transition: transform 0.1s;
        }
        .btn-main:hover { transform: scale(1.02); background: #fff; }
        .btn-secondary { background: #555; color: white; width: auto; font-size: 0.9em; padding: 10px 20px; }
        .btn-small { padding: 5px 10px; font-size: 1.2em; font-weight: bold; cursor: pointer; }

        /* GAME UI */
        .zone {
            background: rgba(0,0,0,0.3); border: 2px solid #5c4a35;
            padding: 10px; border-radius: 10px; min-height: 110px; position: relative;
        }
        .card-container { display: flex; justify-content: center; gap: 8px; flex-wrap: wrap; }
        .card {
            width: 60px; height: 90px; background: var(--card-bg); color: black;
            border-radius: 4px; display: flex; flex-direction: column;
            align-items: center; justify-content: center; font-weight: bold;
            cursor: pointer; user-select: none; position: relative;
        }
        .card.red { color: #c00; }
        .card.black { color: #111; }
        .card:hover { transform: translateY(-5px); border: 2px solid white; }
        .card-corner { position: absolute; top: 2px; left: 4px; font-size: 0.7em; }
        .card-hint { font-size: 0.6em; color: #555; margin-top: 2px; font-weight: normal; }

        /* LOG */
        #log {
            height: 80px; overflow-y: auto; background: #111; border: 1px solid #444;
            padding: 5px; font-size: 0.8em; text-align: left; margin-bottom: 10px; color: cyan;
        }

        /* SCOREBOARD & FOOTER */
        .match-score {
            display: flex; justify-content: space-around; background: #222;
            padding: 10px; border-radius: 5px; margin-bottom: 10px; border: 1px solid #555;
        }
        .score-val { font-size: 1.5em; color: var(--text-gold); font-weight: bold; }
        
        #cheat-sheet {
            position: fixed; bottom: 0; left: 0; right: 0; background: #1a1510;
            border-top: 2px solid var(--text-gold); padding: 8px; display: none;
            justify-content: space-around; font-size: 0.75em; color: var(--text-gold); z-index: 100;
        }
        .legend-item b { color: white; display: block; font-size: 1.1em; }

        /* MANUAL */
        .ref-card {
            background: var(--parchment); color: var(--ink); padding: 15px;
            border-radius: 5px; box-shadow: 0 0 10px rgba(0,0,0,0.5);
            font-family: Arial, sans-serif; text-align: left;
        }
        .ref-table { width: 100%; border-collapse: collapse; margin-top: 5px; font-size: 0.9em; }
        .ref-table th { border-bottom: 2px solid var(--ink); text-align: left; }
        .ref-table td { border-bottom: 1px solid #ccc; padding: 4px 0; }

        /* ANIMATIONS */
        .scan-line { width: 100%; height: 2px; background: cyan; animation: flash 1s infinite; margin: 10px 0; }
        @keyframes flash { 0% { opacity: 0; } 50% { opacity: 1; } 100% { opacity: 0; } }
    </style>
</head>
<body>

    <div id="cheat-sheet">
        <div class="legend-item"><b>J</b>Draw 2, Disc 1</div>
        <div class="legend-item"><b>Q</b>Remove Opp Card</div>
        <div class="legend-item"><b>K</b>Opp Disc 2</div>
        <div class="legend-item"><b>A</b>Steal Opp Brew</div>
    </div>

    <div id="landing-screen" class="screen active-screen">
        <h1 style="font-size: 3em;">üç∫</h1>
        <h1>THE TAPROOM</h1>
        <p><i>Smart AI Edition v7.0</i></p>
        <hr style="border-color: #444; width: 50%;">
        <br>
        <button class="btn-main" onclick="goToManualMode()">üõ†Ô∏è Manual Assistant</button>
        <p style="font-size:0.8em; color:gray;">(Rules, Calculator & Scoreboard)</p>
        <br>
        <button class="btn-main" onclick="startNewMatch()">ü§ñ Play vs. Bartender</button>
        <p style="font-size:0.8em; color:gray;">(Race to 3 Shifts)</p>
    </div>

    <div id="manual-screen" class="screen">
        <button class="btn-main btn-secondary" onclick="goHome()">‚Üê Back</button>
        <h2>Physical Assistant</h2>
        <div class="match-score">
            <div>YOU<br><span id="manual-p-score" class="score-val">0</span></div>
            <div style="padding-top:10px;">SHIFTS<br><span style="font-size:0.7em">(First to 3)</span></div>
            <div>OPP<br><span id="manual-o-score" class="score-val">0</span></div>
        </div>
        <div style="display:flex; justify-content:center; gap:10px; margin-bottom:10px;">
            <button class="btn-small" onclick="modManualScore('p',1)">+ You</button>
            <button class="btn-small" onclick="modManualScore('o',1)">+ Opp</button>
            <button class="btn-small" style="background:#444;" onclick="modManualScore('reset',0)">Reset</button>
        </div>

        <div class="ref-card">
            <h3>THE TURN</h3>
            <ol style="padding-left:20px; margin:5px;">
                <li><b>Pour:</b> Draw 1.</li>
                <li><b>Serve:</b> Play Brew, Play Patron, or Waste.</li>
            </ol>
            <h3>THE MENU</h3>
            <table class="ref-table">
                <tr><td><b>Jack</b></td><td>Draw 2, Discard 1.</td></tr>
                <tr><td><b>Queen</b></td><td>Remove 1 from opp. Flight.</td></tr>
                <tr><td><b>King</b></td><td>Opp. discards 2.</td></tr>
                <tr><td><b>Ace</b></td><td>Steal 1 Brew from opp. Flight.</td></tr>
            </table>
            <h3>LAST CALL</h3>
            <p style="font-size:0.9em;">Start turn with 4 cards -> Yell "Last Call!". Opponent gets 1 final turn. If flight breaks (<4), game continues.</p>
        </div>
        <div class="tool-panel" style="margin-top:10px; background:var(--panel-bg); padding:10px; border-radius:5px;">
            <button class="btn-main btn-secondary" onclick="runTiebreaker('MANUAL')">üéÄ Cuteness Tiebreaker</button>
        </div>
    </div>

    <div id="tiebreaker-screen" class="screen">
        <h2>üéÄ Cuteness Algorithm üéÄ</h2>
        <div id="scan-anim"><p>Scanning...</p><div class="scan-line"></div></div>
        <div id="tiebreaker-final" style="display:none;">
            <h3 id="tiebreaker-winner" style="color:var(--text-gold);"></h3>
            <p id="tiebreaker-reason"></p>
            <button id="tiebreaker-continue-btn" class="btn-main">Continue</button>
        </div>
    </div>

    <div id="game-screen" class="screen">
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <button class="btn-main btn-secondary" style="padding:5px 10px;" onclick="if(confirm('Quit Match?')) goHome()">Exit</button>
            <div class="match-score" style="margin:0; padding:5px; border:none; background:transparent;">
                <span style="color:white;">You: <b id="game-p-wins" style="color:var(--text-gold)">0</b></span>
                <span style="margin:0 10px;">|</span>
                <span style="color:white;">CPU: <b id="game-c-wins" style="color:var(--text-gold)">0</b></span>
            </div>
        </div>

        <div class="zone" style="margin-top:10px;">
            <div style="font-size:0.8em; color:gray;">Bartender's Flight</div>
            <div id="cpu-flight" class="card-container"></div>
        </div>
        <div style="font-size:0.8em; text-align:right;">Hand: <span id="cpu-hand-count">3</span></div>

        <div id="log"></div>
        
        <div id="controls-area" style="background:#222; padding:10px; border-radius:5px; margin:5px 0;">
            <div id="turn-indicator" style="font-weight:bold; color:var(--text-gold);">Starting...</div>
            <div id="player-options" style="display:none; margin-top:5px;">
                <label><input type="checkbox" id="waste-mode"> üóëÔ∏è Waste Mode</label>
            </div>
        </div>

        <div class="zone" style="background:var(--panel-bg);">
            <div style="font-size:0.8em; color:gray;">Your Flight</div>
            <div id="player-flight" class="card-container"></div>
        </div>

        <div class="zone">
            <div style="font-size:0.8em; color:gray;">Your Hand</div>
            <div id="player-hand" class="card-container"></div>
        </div>
    </div>

<script>
    // --- HELPERS ---
    const SUITS = ['‚ô•', '‚ô¶', '‚ô£', '‚ô†'];
    const RANKS = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
    
    function showScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active-screen'));
        document.getElementById(id).classList.add('active-screen');
        const sheet = document.getElementById('cheat-sheet');
        sheet.style.display = (id === 'game-screen') ? 'flex' : 'none';
    }
    function goHome() { showScreen('landing-screen'); }
    function goToManualMode() { showScreen('manual-screen'); }

    // --- MANUAL SCORE ---
    let mPWins=0, mOWins=0;
    function modManualScore(who, amt) {
        if(who==='reset') { mPWins=0; mOWins=0; }
        else if(who==='p') { mPWins+=amt; if(mPWins>3) mPWins=3; }
        else { mOWins+=amt; if(mOWins>3) mOWins=3; }
        document.getElementById('manual-p-score').innerText = mPWins;
        document.getElementById('manual-o-score').innerText = mOWins;
    }

    // --- TIEBREAKER ---
    function runTiebreaker(ctx) {
        showScreen('tiebreaker-screen');
        document.getElementById('scan-anim').style.display='block';
        document.getElementById('tiebreaker-final').style.display='none';
        setTimeout(()=>{
            document.getElementById('scan-anim').style.display='none';
            document.getElementById('tiebreaker-final').style.display='block';
            let winner = Math.random()>0.5?"You":(ctx==='GAME'?"The Bartender":"Opponent");
            let reason = ["is radiating charm.", "has better hair.", "is objectively cuter.", "has a winning smile."][Math.floor(Math.random()*4)];
            document.getElementById('tiebreaker-winner').innerText = winner==="You"?"You are Cuter!":`${winner} is Cuter!`;
            document.getElementById('tiebreaker-reason').innerText = `Reason: ${winner} ${reason}`;
            document.getElementById('tiebreaker-continue-btn').onclick=()=>{
                if(ctx==='MANUAL') showScreen('manual-screen');
                else startShift(winner==="You"?'PLAYER':'CPU');
            };
        }, 1500);
    }

    // --- GAME LOGIC ---
    let matchPWins=0, matchCWins=0;
    let deck=[], pHand=[], cHand=[], pFlight=[], cFlight=[];
    let turn="", gameState="IDLE", lastCallCaller=null, pendingAction=null;

    class Card {
        constructor(r, s) {
            this.r = r; this.s = s;
            this.isBrew = !isNaN(parseInt(r));
            this.val = this.isBrew ? parseInt(r) : 0;
            this.uid = Math.random().toString(36);
        }
        getEffectName() {
            if(this.r==='J') return "Draw 2, Disc 1";
            if(this.r==='Q') return "Remove Opp Card";
            if(this.r==='K') return "Opp Disc 2";
            if(this.r==='A') return "Steal Brew";
            return "";
        }
    }

    function startNewMatch() { matchPWins=0; matchCWins=0; updateMatchUI(); runTiebreaker('GAME'); }
    function updateMatchUI() { document.getElementById('game-p-wins').innerText=matchPWins; document.getElementById('game-c-wins').innerText=matchCWins; }
    function log(msg) { 
        const d=document.getElementById('log'); 
        d.innerHTML += `<div>> ${msg}</div>`; d.scrollTop=d.scrollHeight; 
    }

    function startShift(starter) {
        showScreen('game-screen');
        deck=[]; for(let s of SUITS) for(let r of RANKS) deck.push(new Card(r,s));
        deck.sort(()=>Math.random()-0.5);
        pHand=[deck.pop(),deck.pop(),deck.pop()];
        cHand=[deck.pop(),deck.pop(),deck.pop()];
        pFlight=[]; cFlight=[]; lastCallCaller=null;
        document.getElementById('log').innerHTML="";
        log(`Shift Started. ${starter} goes first.`);
        startTurn(starter);
    }

    function startTurn(who) {
        turn = who;
        
        // Last Call Logic
        if(lastCallCaller !== null && turn === lastCallCaller) {
            let flight = (turn==='PLAYER') ? pFlight : cFlight;
            if(flight.length===4) { endShift(); return; }
            else { log(`üö´ Last Call Broken! Play continues.`); lastCallCaller=null; }
        }

        let myFlight = (who==='PLAYER') ? pFlight : cFlight;
        if(myFlight.length===4 && lastCallCaller===null) {
            lastCallCaller = who;
            log(`üîî ${who} yells "Last Call!"`);
            renderGame();
            setTimeout(()=>startTurn(who==='PLAYER'?'CPU':'PLAYER'), 2000);
            return;
        }

        document.getElementById('turn-indicator').innerText = `${who==='PLAYER'?'YOUR':"BARTENDER'S"} TURN`;
        document.getElementById('turn-indicator').style.color = who==='PLAYER'?'#0f0':'#f00';

        if(deck.length) {
            let c = deck.pop();
            if(who==='PLAYER') pHand.push(c); else cHand.push(c);
        }
        renderGame();

        if(who==='PLAYER') {
            gameState='PLAY'; document.getElementById('player-options').style.display='block';
            document.getElementById('waste-mode').checked=false;
        } else {
            document.getElementById('player-options').style.display='none';
            setTimeout(cpuTurn, 1500);
        }
    }

    // --- SMART AI ---
    function cpuTurn() {
        let played = false;

        // 1. EMERGENCY: Break Player Last Call
        if(lastCallCaller === 'PLAYER' && pFlight.length === 4) {
            let qIdx = cHand.findIndex(c => c.r === 'Q');
            if(qIdx !== -1) {
                cHand.splice(qIdx, 1); pFlight.pop();
                log(`üö® Bartender breaks Last Call with Queen!`);
                renderGame(); startTurn('PLAYER'); return;
            }
            let aIdx = cHand.findIndex(c => c.r === 'A');
            if(aIdx !== -1 && cFlight.length < 4) {
                cHand.splice(aIdx, 1); cFlight.push(pFlight.pop());
                log(`üö® Bartender breaks Last Call with Ace!`);
                renderGame(); startTurn('PLAYER'); return;
            }
        }

        // 2. SMART STEAL (Target 9s, 10s, or Bonus Suits)
        let bestStealIdx = -1;
        let aIdx = cHand.findIndex(c => c.r === 'A');
        if(!played && aIdx !== -1 && pFlight.length > 0 && cFlight.length < 4) {
            // Find highest value card in player flight
            let bestVal = 0;
            pFlight.forEach((c, i) => { if(c.val > bestVal) { bestVal = c.val; bestStealIdx = i; } });
            
            // Prioritize stealing if card is 9 or 10
            if(bestVal >= 9) {
                cHand.splice(aIdx, 1);
                cFlight.push(pFlight.splice(bestStealIdx, 1)[0]);
                log(`ü§ñ Bartender steals your ${bestVal} with Ace!`);
                played = true;
            }
        }

        // 3. SMART REMOVE (Target 9s, 10s)
        if(!played) {
            let qIdx = cHand.findIndex(c => c.r === 'Q');
            if(qIdx !== -1 && pFlight.length > 0) {
                 let bestVal = 0; let target = -1;
                 pFlight.forEach((c, i) => { if(c.val > bestVal) { bestVal = c.val; target = i; } });
                 
                 // Only use Queen if player has something worth removing
                 if(bestVal >= 8) {
                     cHand.splice(qIdx, 1);
                     pFlight.splice(target, 1);
                     log(`ü§ñ Bartender removes your ${bestVal} with Queen.`);
                     played = true;
                 }
            }
        }

        // 4. BONUS HUNTING (Flush/Color)
        if(!played && cFlight.length > 0 && cFlight.length < 4) {
            // Check major suit in flight
            let suits = cFlight.map(c => c.s);
            let dominantSuit = suits.sort((a,b) => suits.filter(v => v===a).length - suits.filter(v => v===b).length).pop();
            
            // Find card in hand matching dominant suit
            let matchIdx = cHand.findIndex(c => c.isBrew && c.s === dominantSuit);
            if(matchIdx !== -1) {
                let c = cHand.splice(matchIdx, 1)[0];
                cFlight.push(c);
                log(`ü§ñ Bartender plays ${c.r}${c.s} (Chasing Bonus!)`);
                played = true;
            }
        }

        // 5. HIGH VALUE PLAY (8+)
        if(!played) {
            let bIdx = cHand.findIndex(c => c.isBrew && c.val >= 8);
            if(bIdx !== -1 && cFlight.length < 4) {
                let c = cHand.splice(bIdx, 1)[0];
                cFlight.push(c);
                log(`ü§ñ Bartender serves High Brew ${c.r}${c.s}`);
                played = true;
            }
        }

        // 6. STRATEGIC WASTE (Don't play junk if not winning)
        // If holding only low cards (2-7) and flight isn't full, throw one away to dig for gold.
        if(!played) {
            let lowCardIdx = cHand.findIndex(c => c.isBrew && c.val < 8);
            // Only waste if we aren't about to win (flight length 3)
            if(lowCardIdx !== -1 && cFlight.length < 3) {
                 let w = cHand.splice(lowCardIdx, 1)[0];
                 log(`ü§ñ Bartender thinks hand is weak. Wastes ${w.r}${w.s}.`);
                 played = true;
            }
        }

        // 7. FALLBACK (Play anything legal)
        if(!played) {
            // Try to play any brew
            let anyB = cHand.findIndex(c => c.isBrew);
            if(anyB !== -1 && cFlight.length < 4) {
                let c = cHand.splice(anyB, 1)[0];
                cFlight.push(c);
                log(`ü§ñ Bartender serves ${c.r}${c.s}`);
                played = true;
            }
            // Or use an effect just to use it
            else if (cHand.length > 0) {
                 // Try Ace/Queen on whatever
                 let aIdx2 = cHand.findIndex(c => c.r === 'A');
                 let qIdx2 = cHand.findIndex(c => c.r === 'Q');
                 
                 if(aIdx2 !== -1 && pFlight.length > 0 && cFlight.length < 4) {
                     cHand.splice(aIdx2, 1); cFlight.push(pFlight.pop());
                     log("ü§ñ Bartender plays Ace.");
                 }
                 else if(qIdx2 !== -1 && pFlight.length > 0) {
                     cHand.splice(qIdx2, 1); pFlight.pop();
                     log("ü§ñ Bartender plays Queen.");
                 }
                 else {
                     // Just waste first card
                     let w = cHand.shift();
                     log(`ü§ñ Bartender wastes ${w.r}${w.s}`);
                 }
            }
        }

        renderGame();
        startTurn('PLAYER');
    }

    // --- PLAYER ACTIONS ---
    window.cardAction = function(loc, uid) {
        if(turn !== 'PLAYER') return;
        if(loc==='HAND' && gameState==='PLAY') {
            const idx = pHand.findIndex(c => c.uid === uid);
            const card = pHand[idx];
            if(document.getElementById('waste-mode').checked) {
                pHand.splice(idx,1); log(`Wasted ${card.r}${card.s}`); nextTurn(); return;
            }
            if(card.isBrew) {
                if(pFlight.length<4) { pHand.splice(idx,1); pFlight.push(card); log(`Served ${card.r}${card.s}`); nextTurn(); }
                else alert("Flight Full!");
            } else {
                if(card.r==='A' && (cFlight.length===0 || pFlight.length===4)) { alert("Cannot steal."); return; }
                if(card.r==='Q' && cFlight.length===0) { alert("Nothing to remove."); return; }
                handlePatron(card, idx);
            }
        }
        else if(loc==='HAND' && gameState==='DISCARD') {
            pHand.splice(pHand.findIndex(c=>c.uid===uid),1); log("Discarded."); nextTurn();
        }
        else if(loc==='CPU' && gameState==='TARGET') {
            if(pendingAction) pendingAction(cFlight.findIndex(c=>c.uid===uid));
        }
    }

    function handlePatron(c, i) {
        if(c.r==='J') { 
            pHand.splice(i,1); if(deck.length) pHand.push(deck.pop()); if(deck.length) pHand.push(deck.pop());
            log("Jack played. Discard 1."); gameState='DISCARD'; renderGame();
        }
        else if(c.r==='K') {
            pHand.splice(i,1); if(cHand.length) cHand.pop(); if(cHand.length) cHand.pop();
            log("King played. Bartender discards 2."); nextTurn();
        }
        else if(c.r==='Q') {
            pHand.splice(i,1); log("Select card to Remove."); gameState='TARGET';
            pendingAction=(t)=>{ cFlight.splice(t,1); log("Removed card."); nextTurn(); }; renderGame();
        }
        else if(c.r==='A') {
            pHand.splice(i,1); log("Select card to Steal."); gameState='TARGET';
            pendingAction=(t)=>{ pFlight.push(cFlight.splice(t,1)[0]); log("Stole card."); nextTurn(); }; renderGame();
        }
    }

    function nextTurn() { gameState='IDLE'; renderGame(); startTurn('CPU'); }

    function renderGame() {
        const rC = (c,l) => {
            const clk = (l==='HAND'&&turn==='PLAYER')||(l==='CPU'&&gameState==='TARGET');
            return `<div class="card ${['‚ô•','‚ô¶'].includes(c.s)?'red':'black'}" style="${clk?'border:2px solid cyan':''}" onclick="cardAction('${l}','${c.uid}')"><div class="card-corner">${c.r}</div><div>${c.s}</div>${l==='HAND'?`<div class="card-hint">${c.getEffectName()}</div>`:''}</div>`;
        };
        document.getElementById('p-flight').innerHTML = pFlight.map(c=>rC(c,'P_FLIGHT')).join('');
        document.getElementById('c-flight').innerHTML = cFlight.map(c=>rC(c,'CPU')).join('');
        document.getElementById('p-hand').innerHTML = pHand.map(c=>rC(c,'HAND')).join('');
        document.getElementById('cpu-hand-count').innerText = cHand.length;
        // Fix ID ref
        document.getElementById('player-flight').innerHTML = pFlight.map(c=>rC(c,'P_FLIGHT')).join('');
        document.getElementById('cpu-flight').innerHTML = cFlight.map(c=>rC(c,'CPU')).join('');
        document.getElementById('player-hand').innerHTML = pHand.map(c=>rC(c,'HAND')).join('');
    }

    function calcScore(f) {
        if(!f.length) return 0;
        let s=f.reduce((a,b)=>a+b.val,0);
        if(f.length===4) {
            if(new Set(f.map(c=>c.s)).size===1) s+=20;
            else { let r=f.filter(c=>['‚ô•','‚ô¶'].includes(c.s)).length; if(r===0||r===4) s+=10; }
        }
        return s;
    }

    function endShift() {
        let ps=calcScore(pFlight), cs=calcScore(cFlight);
        let msg = `SHIFT OVER!\nYou: ${ps} | Bartender: ${cs}\n`;
        if(ps>cs) { msg+="üèÜ YOU WIN!"; matchPWins++; }
        else if(cs>ps) { msg+="üíÄ BARTENDER WINS."; matchCWins++; }
        else msg+="ü§ù TIE.";
        alert(msg); updateMatchUI();
        if(matchPWins>=3) { if(confirm("YOU WON THE MATCH! Play again?")) startNewMatch(); else goHome(); }
        else if(matchCWins>=3) { if(confirm("BARTENDER WON THE MATCH. Retry?")) startNewMatch(); else goHome(); }
        else startShift(ps>cs?'PLAYER':(cs>ps?'CPU':(Math.random()>.5?'PLAYER':'CPU')));
    }
</script>
</body>
</html>
